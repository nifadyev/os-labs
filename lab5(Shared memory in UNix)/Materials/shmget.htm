<html><head>

<meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><title>Shmget</title></head><body topmargin="30" leftmargin="30" bgcolor="#ffffff" link="#0000ff" vlink="#800080">

<h1 align="center"><font face="Times New Roman">Системный вызов</font> shmget</h1>
<b><font face="Times New Roman" size="5"><p>Прототип системного вызова</p></font>
</b>
<dir><font color="#008000"> 
  <blockquote><b>#include &lt;sys/types.h&gt;<br>
    #include &lt;sys/ipc.h&gt;<br>
    #include &lt;sys/shm.h&gt;<br>
    <br>
    int shmget(key_t key, int size, int shmflg); </b></blockquote>
  </font></dir>

<b><font face="Times New Roman" size="5"><p>Описание системного вызова</p></font></b>
<dir><font face="Times New Roman" size="5"><b> </b></font> 
  <blockquote> 
    <p align="justify"><font face="Times New Roman">Системный вызов</font> <b><font color="#008000">shmget 
      </font></b><font face="Times New Roman">предназначен для выполнения операции 
      доступа к сегменту разделяемой памяти и, в случае ее успешного завершения, 
      возврашает дескриптор System V IPC для этого сегмента (целое неотрицательное 
      число, однозначно характеризующее сегмент внутри вычислительной системы 
      и использующееся в дальнейшем для других операций с ним).</font> 
  </p></blockquote>
  <blockquote> 
    <p align="justify"><font face="Times New Roman">Параметр <b><font color="#008000">key</font></b> 
      является ключом System V IPC для сегмента, т.е. фактически его именем из 
      пространства имен System V IPC. В качестве значения этого параметра может 
      быть использовано значение ключа, полученное с помощью функции <b><font color="#008000"><a href="http://cs.mipt.ru/docs/courses/osstud/man/ftok.htm">ftok()</a></font></b>, 
      или специальное значение<b><font color="#008000"> IPC_PRIVATE</font></b>. 
      Использование значения<b><font color="#008000"> IPC_PRIVATE</font></b> <b><u>всегда</u></b> 
      приводит к попытке создания нового сегмента разделяемой памяти с ключом, 
      который не совпадает со значением ключа ни одного из уже существующих сегментов 
      и который не может быть получен с помощью функции <a href="http://cs.mipt.ru/docs/courses/osstud/man/ftok.htm"><b>ftok()</b></a> 
      ни при одной комбинации ее параметров.<br>
      Параметр <b><font color="#008000">size</font></b> определяет размер создаваемого 
      или уже существующего сегмента в байтах. В случае, если сегмент с указанным 
      ключом уже существует, но его размер не совпадает с указанным в параметре 
      <b><font color="#008000">size</font></b>, констатируется возникновение ошибки.</font><font face="Times New Roman"><br>
      Параметр<b><font color="#008000"> shmflg</font></b> - флаги - играет роль 
      только при создании нового сегмента разделяемой памяти и определяет права 
      различных пользователей при доступе к сегменту, а также необходимость создания 
      нового сегмента и поведение системного вызова при попытке создания. Он является 
      некоторой комбинацией (с помощью операции побитовое или - "|") 
      следующих предопределенных значений и восьмеричных прав доступа:<br>
      <br>
      </font> 
  </p></blockquote>
  <blockquote> 
    <dir><font face="Times New Roman"> </font><font face="Times New Roman"> 
      <table border="0" cellpadding="0" cellspacing="0" width="77%">
        <tbody><tr> 
          <td valign="top" width="24%"><b><font color="#008000">IPC_CREAT</font></b></td>
          <td width="76%"> 
            <p align="justify"> <b></b><font face="Times New Roman">- если сегмент 
              для указанного ключа не существует, он должен быть создан.</font> 
          </p></td>
        </tr>
        <tr> 
          <td valign="top" width="24%"><b><font color="#008000">IPC_EXCL</font></b><font face="Times New Roman"></font></td>
          <td width="76%"><font face="Times New Roman">- применяется совместно 
            с флагом </font><b><font color="#008000">IPC_CREAT</font></b><font face="Times New Roman">. 
            При совместном их использовании и существовании сегмента с указанным 
            ключом, доступ к сегменту не производится и констатируется ошибочная 
            ситуация, при этом переменная <font color="#008000"><b>errno</b></font>,
            описанная в файле <font color="#008000"><b>errno.h</b></font>,
            примет значение <font color="#008000"><b>EEXIST</b></font>.</font></td>
        </tr>
        <tr> 
          <td valign="top" width="24%"><font color="#008000"><b>0400</b></font></td>
          <td width="76%">- Разрешено чтение для пользователя, создавшего сегмент.</td>
        </tr>
        <tr> 
          <td valign="top" width="24%"><font color="#008000"><b>0200</b></font></td>
          <td width="76%">- Разрешена запись для пользователя, создавшего сегмент.</td>
        </tr>
        <tr> 
          <td valign="top" width="24%"><font color="#008000"><b>0040</b></font></td>
          <td width="76%">- Разрешено чтение для группы пользователя, создавшего 
            сегмент.</td>
        </tr>
        <tr> 
          <td valign="top" width="24%"><font color="#008000"><b>0020</b></font></td>
          <td width="76%">- Разрешена запись для группы пользователя, создавшего 
            сегмент.</td>
        </tr>
        <tr> 
          <td valign="top" width="24%"><font color="#008000"><b>0004</b></font></td>
          <td width="76%">- Разрешено чтение для всех остальных пользователей</td>
        </tr>
        <tr> 
          <td valign="top" width="24%"><font color="#008000"><b>0002</b></font></td>
          <td width="76%">- Разрешена запись для всех остальных пользователей</td>
        </tr>
      </tbody></table>
      </font> </dir>
    <br>
  </blockquote>
  <b><font face="Times New Roman" size="5"> 
  <p>Возвращаемое значение</p>
  </font> </b> 
  <blockquote> 
    <p align="justify"> <font face="Times New Roman"> Системный вызов возвращает 
      значение дескриптора System V IPC для сегмента разделяемой памяти при нормальном 
      завершении и значение -1 при возникновении ошибки</font>. 
  </p></blockquote>
</dir>
</body></html>