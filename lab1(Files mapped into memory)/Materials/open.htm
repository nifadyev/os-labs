<html><head>

<meta http-equiv="Content-Type" content="text/html; charset=windows-1251"><title>open</title></head><body topmargin="30" leftmargin="30" bgcolor="#ffffff" link="#0000ff" vlink="#800080">

<h1 align="center"><font face="Times New Roman">Системный вызов</font> open</h1>
<b><font face="Times New Roman" size="5"><p>Прототип системного вызова</p></font>
</b>
<dir><font color="#008000"> 
  <blockquote><b>#include &lt;fcntl.h&gt;<br>
    <br>
    int open(char *path, int flags);<br>
   int open(char *path, int flags, int mode);
	</b></blockquote>
  </font></dir>

<b><font face="Times New Roman" size="5"><p>Описание системного вызова</p></font></b>
<dir><font face="Times New Roman" size="5"><b> </b></font> 
  <blockquote> 
    <p align="justify"><font face="Times New Roman">Системный вызов</font> <b><font color="#008000">open</font></b> 
      <font face="Times New Roman">предназначен для выполнения операции открытия 
      файла и, в случае ее удачного осуществления, возвращает файловый дескриптор 
      открытого файла (небольшое неотрицательное целое число, которое используется 
      в дальнейшем для других операций с этим файлом).</font> 
  </p></blockquote>
  <blockquote> 
    <p align="justify"><font face="Times New Roman">Параметр </font><b><font color="#008000">path</font></b><font face="Times New Roman"> 
      является указателем на строку, содержащую полное или относительное имя файла.<br>
      Параметр </font><b><font color="#008000">flags</font></b><font face="Times New Roman"> 
      может принимать одно из следующих трех значений:<br>
      <br>
      </font> 
    </p><dir> 
      <p align="justify"> <b><font color="#008000">O_RDONLY</font></b><font face="Times New Roman"> 
        - если над файлом в дальнейшем будут совершаться только операции чтения;<br>
        </font><b><font color="#008000">O_WRONLY</font></b><font face="Times New Roman"> 
        - если над файлом в дальнейшем будут осуществляться только операции записи;<br>
        </font><b><font color="#008000">O_RDWR</font></b><font face="Times New Roman"> 
        - если над файлом будут осуществляться и операции чтения, и операции записи.<br>
        <br>
        </font> 
    </p></dir>
  </blockquote>
  <blockquote> 
    <p align="justify"><font face="Times New Roman">Каждое из этих значений может 
      быть скомбинировано посредством операции "побитовое или ( | )" 
      с одним или несколькими следующими флагами: <br>
      <br>
      </font> 
    </p><dir> 
      <p align="justify"> <b><font color="#008000">O_CREAT</font></b><font face="Times New Roman">- 
        если файл с указанным именем не существует, он должен быть создан.<br>
        </font><b><font color="#008000">O_EXCL</font></b><font face="Times New Roman"> 
        - применяется совместно с флагом </font><b><font color="#008000">O_CREAT</font></b><font face="Times New Roman">. 
        При совместном их использовании и существовании файла с указанным именем, 
        открытие файла не производится и констатируется ошибочная ситуация.<br>
        </font><b><font color="#008000">O_NDELAY</font></b><font face="Times New Roman"> 
        - запрещает перевод процесса в состояние <b><i>ожидание</i></b> при выполнении 
        операции открытия и любых последующих операциях над этим файлом.<br>
        </font><b><font color="#008000">O_APPEND</font></b><font face="Times New Roman"> 
        - при открытии файла и перед выполнением каждой операции записи (если 
        она, конечно, разрешена) указатель текущей позиции в файле устанавливается 
        на конец файла.<br>
        </font><b><font color="#008000">O_TRUNC</font></b><font face="Times New Roman"> 
        - если файл существует, уменьшить его размер до 0, с сохранением существующих 
        атрибутов файла, кроме, быть может, времен последнего доступа к файлу 
        и его последней модификации.<br>
        <br>
        </font> 
    </p></dir>
    <font face="Times New Roman"> 
    </font><p align="justify"><font face="Times New Roman"> Кроме того, в некоторых версиях операционной системы UNIX 
      могут применяться дополнительные значения флагов:<br>
      <br>
    </font> 
    </p><dir> 
      <p align="justify"><b><font color="#008000">O_SYNC</font></b><font face="Times New Roman"> 
        - любая операция записи в файл будет блокироваться (т.&nbsp;е. процесс 
        будет переведен в состояние <b><i>ожидание</i></b>) до тех пор, пока записанная 
        информация не будет физически помещена на соответсвующий низлежащий уровень 
        hardware.<br>
        </font><b><font color="#008000">O_NOCTTY</font></b><font face="Times New Roman"> 
        - если имя файла относится к терминальному устройству, оно не становится 
        управляющим терминалом процесса, даже если до этого процесс не имел управляющего 
        терминала.<br>
        <br>
        </font> 
    </p></dir>
    <p align="justify"><a name="open1"></a> <font face="Times New Roman"> Параметр 
      </font><b><font color="#008000">mode</font></b><font face="Times New Roman"> 
      устанавливает атрибуты прав доступа различных категорий пользователей к 
      новому файлу при его создании. Он обязателен в том случае, если среди заданных 
      флагов присутствует флаг </font><b><font color="#008000">O_CREAT</font></b> 
    <font face="Times New Roman"> и может быть опущен в противном случае. Этот 
    параметр задается как сумма следующих восьмеричных значений:<br>
    <br>
    <table align="center" border="0" cellpadding="0" cellspacing="0" width="66%">
      <tbody><tr> 
        <td valign="top" width="11%"><font color="#008000"><b>0400</b></font></td>
        <td width="89%">&nbsp;- Разрешено чтение для пользователя, создавшего 
          файл.</td>
      </tr>
      <tr> 
        <td valign="top" width="11%"><font color="#008000"><b>0200</b></font></td>
        <td width="89%">&nbsp;- Разрешена запись для пользователя, создавшего 
          файл.</td>
      </tr>
      <tr> 
        <td valign="top" width="11%"><font color="#008000"><b>0100</b></font></td>
        <td width="89%">&nbsp;- Разрешено исполнение для пользователя, создавшего 
          файл.</td>
      </tr>
      <tr> 
        <td valign="top" width="11%"><font color="#008000"><b>0040</b></font></td>
        <td width="89%">&nbsp;- Разрешено чтение для группы пользователя, создавшего 
          файл.</td>
      </tr>
      <tr> 
        <td valign="top" width="11%"><font color="#008000"><b>0020</b></font></td>
        <td width="89%">&nbsp;- Разрешена запись для группы пользователя, создавшего 
          файл.</td>
      </tr>
      <tr> 
        <td valign="top" width="11%"><font color="#008000"><b>0010</b></font></td>
        <td width="89%">&nbsp;- Разрешено исполнение для группы пользователя, 
          создавшего файл.</td>
      </tr>
      <tr> 
        <td valign="top" width="11%"><font color="#008000"><b>0004</b></font></td>
        <td width="89%">&nbsp;- Разрешено чтение для всех остальных пользователей</td>
      </tr>
      <tr> 
        <td valign="top" width="11%"><font color="#008000"><b>0002</b></font></td>
        <td width="89%">&nbsp;- Разрешена запись для всех остальных пользователей</td>
      </tr>
      <tr> 
        <td valign="top" width="11%"><font color="#008000"><b>0001</b></font></td>
        <td width="89%">&nbsp;- Разрешено исполнение для всех остальных пользователей</td>
      </tr>
    </tbody></table>
    <br>
    </font></p><p align="justify"><font face="Times New Roman"> При создании файла реально устанавливаемые права доступа 
      получаются из стандартной комбинации параметра <font color="#008000"><b>mode</b></font> 
      и <a href="http://cs.mipt.ru/docs/courses/osstud/man/umask3.htm">маски создания файлов текущего процесса</a><font color="#008000"> 
      <b>umask</b></font>, а именно - они равны <b> <font color="#008000">mode 
      &amp;<sup> ~</sup>umask</font></b>. <br>
      <br>
      При открытии файлов типа FIFO системный вызов имеет некоторые особенности 
      поведения по сравнению с открытием файлов других типов. Если FIFO открывается 
      только для чтения, и не задан флаг <font color="#008000"><b>O_NDELAY</b></font>, 
      то процесс, осуществивший системный вызов, блокируется до тех пор, пока 
      какой-либо другой процесс не откроет FIFO на запись. Если флаг <b><font color="#008000">O_NDELAY</font></b> 
      задан, то возвращается значение файлового дескриптора, ассоциированного 
      с FIFO. Если FIFO открывается только для записи, и не задан флаг <font color="#008000"><b>O_NDELAY</b></font>, 
      то процесс, осуществивший системный вызов, блокируется до тех пор, пока 
      какой-либо другой процесс не откроет FIFO на чтение. Если флаг <font color="#008000"><b>O_NDELAY</b></font> 
      задан, то констатируется возникновение ошибки и возвращается значение -1.<br>
      <br>
    </font></p></blockquote>
  <b><font face="Times New Roman" size="5"> 
  <p>Возвращаемое значение</p>
  </font> </b> 
  <blockquote> 
    <p align="justify"> <font face="Times New Roman"> Системный вызов возвращает 
      значение файлового дескриптора для открытого файла при нормальном завершении 
      и значение -1 при возникновении ошибки</font>. 
  </p></blockquote>
</dir>
</body></html>